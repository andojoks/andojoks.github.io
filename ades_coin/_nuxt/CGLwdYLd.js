import{d as Z,P as ee,Q as te,i as S,r as v,g as a,t as le,y as e,v as i,z as t,s as oe,A as u,B as ae,C as ne,_ as re}from"./DU4BFfAJ.js";import{u as se}from"./ChIxkut-.js";import{u as ie}from"./DTgbHbZG.js";import"./DvF23Exx.js";const m=f=>(ae("data-v-58c9e3f9"),f=f(),ne(),f),de={class:"d-flex justify-space-between"},ce=m(()=>i("span",{class:"font-weight-bold text-h4 text-primary"},"Crops",-1)),ue=["colspan"],pe={class:"d-flex justify-space-between"},_e=m(()=>i("span",{class:"font-weight-bold text-h6 text-primary"},"Availability Locations",-1)),ve=m(()=>i("span",null,"Add Crop",-1)),me=m(()=>i("h3",null,"Orders",-1)),fe=m(()=>i("span",null,"Create Order",-1)),be=Z({__name:"[id]",setup(f){var N,U;const P=ee(),b=se(),Q=ie(),{crops:F}=te(Q),R=P.params.id,o=S(()=>b.farmers.find(c=>c.id===R)),z=v([{title:"Farmers",disabled:!1,href:"/users/farmers"},{title:`Farmer: ${(N=o==null?void 0:o.value)==null?void 0:N.firstName}  ${(U=o==null?void 0:o.value)==null?void 0:U.lastName}`,disabled:!0,href:""}]),E=S(()=>{var l,p,n,k;let c=((p=(l=o==null?void 0:o.value)==null?void 0:l.crops)==null?void 0:p.map(s=>s.crop_id))||[];return((k=(n=F.value)==null?void 0:n.filter(s=>!c.includes(s.id)))==null?void 0:k.map(s=>{var h,_;let V=((_=(h=o.value)==null?void 0:h.crops.find(g=>g.crop_id==s.id))==null?void 0:_.availability)||[];return{...s,availability:V}}))||[]}),G=[{title:"Crop Name",key:"name"},{title:"Actions",key:"actions",sortable:!1}],J=[{title:"City",key:"availabilty.city"},{title:"State",key:"availabilty.state"},{title:"Country",key:"availabilty.country"},{title:"Actions",key:"actions",sortable:!1}],C=v(!1),y=v({crop_id:""}),A=()=>{y.value={crop_id:""},C.value=!0},q=()=>{C.value=!1},K=()=>{o.value&&(b.addCropToFarmer(o.value.id,{...y.value}),q())},M=c=>{o.value&&b.removeCropFromFarmer(o.value.id,c)},x=v(!1),d=v({crop:"",quantity:0,price:0}),O=S(()=>{var l,p;let c=(((l=o.value)==null?void 0:l.crops)||[]).map(n=>n.crop_id)||[];return((p=F.value)==null?void 0:p.filter(n=>!c.includes(n.id)))||[]}),W=()=>{d.value={crop:"",quantity:0,price:0},x.value=!0},D=()=>{x.value=!1},X=()=>{o.value&&(b.createOrderForFarmer(o.value.id,{...d.value}),D())};return(c,l)=>{const p=a("v-breadcrumbs"),n=a("v-btn"),k=a("v-icon"),s=a("v-data-table"),V=a("v-card-title"),h=a("v-autocomplete"),_=a("v-col"),g=a("v-row"),I=a("v-container"),B=a("v-card-text"),T=a("v-spacer"),$=a("v-card-actions"),j=a("v-card"),H=a("v-dialog"),Y=a("v-select"),L=a("v-text-field");return oe(),le("div",null,[e(p,{items:z.value},null,8,["items"]),i("div",de,[ce,e(n,{color:"primary",onClick:A},{default:t(()=>[u("Add Crop")]),_:1})]),e(s,{items:E.value,headers:G,class:"elevation-1","show-expand":""},{"item.actions":t(({item:r,index:w})=>[e(k,{small:"",onClick:Ce=>M(w)},{default:t(()=>[u("mdi-delete")]),_:2},1032,["onClick"])]),"expanded-row":t(({columns:r,item:w})=>[i("tr",null,[i("td",{colspan:r.length,class:"pa-4"},[i("div",pe,[_e,e(n,{color:"primary",onClick:A},{default:t(()=>[u("Add Location")]),_:1})]),e(s,{items:w.availability,headers:J},null,8,["items"])],8,ue)])]),_:2},1032,["items"]),e(H,{modelValue:C.value,"onUpdate:modelValue":l[1]||(l[1]=r=>C.value=r),"max-width":"600px"},{default:t(()=>[e(j,null,{default:t(()=>[e(V,null,{default:t(()=>[ve]),_:1}),e(B,null,{default:t(()=>[e(I,null,{default:t(()=>[e(g,null,{default:t(()=>[e(_,{cols:"12"},{default:t(()=>[e(h,{items:O.value,"item-value":"id","item-title":"name",modelValue:y.value.crop_id,"onUpdate:modelValue":l[0]||(l[0]=r=>y.value.crop_id=r),label:"Crop",required:""},null,8,["items","modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),e($,null,{default:t(()=>[e(T),e(n,{color:"blue darken-1",variant:"text",onClick:q},{default:t(()=>[u("Cancel")]),_:1}),e(n,{color:"blue darken-1",variant:"text",onClick:K},{default:t(()=>[u("Save")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),me,e(n,{color:"primary",onClick:W},{default:t(()=>[u("Create Order")]),_:1}),e(H,{modelValue:x.value,"onUpdate:modelValue":l[5]||(l[5]=r=>x.value=r),"max-width":"600px"},{default:t(()=>[e(j,null,{default:t(()=>[e(V,null,{default:t(()=>[fe]),_:1}),e(B,null,{default:t(()=>[e(I,null,{default:t(()=>[e(g,null,{default:t(()=>[e(_,{cols:"12"},{default:t(()=>[e(Y,{items:O.value,modelValue:d.value.crop,"onUpdate:modelValue":l[2]||(l[2]=r=>d.value.crop=r),label:"Select Crop",required:""},null,8,["items","modelValue"])]),_:1}),e(_,{cols:"12"},{default:t(()=>[e(L,{modelValue:d.value.quantity,"onUpdate:modelValue":l[3]||(l[3]=r=>d.value.quantity=r),label:"Quantity Available",required:""},null,8,["modelValue"])]),_:1}),e(_,{cols:"12"},{default:t(()=>[e(L,{modelValue:d.value.price,"onUpdate:modelValue":l[4]||(l[4]=r=>d.value.price=r),label:"Price",required:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),e($,null,{default:t(()=>[e(T),e(n,{color:"blue darken-1",variant:"text",onClick:D},{default:t(()=>[u("Cancel")]),_:1}),e(n,{color:"blue darken-1",variant:"text",onClick:X},{default:t(()=>[u("Save")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])])}}}),he=re(be,[["__scopeId","data-v-58c9e3f9"]]);export{he as default};
